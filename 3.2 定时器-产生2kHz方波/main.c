/*-----------------------------------------------
  名称：通过定时0产生2KHz方波
  编写：hongXkeX
  日期：2016.11.17
  修改：无
------------------------------------------------*/

#include "main.h"

sbit sq = P1^0;     //定义方波输出端口

/*------------------------------------------------
                    主程序
------------------------------------------------*/
void main()
{
	init();
	EA = 1;         //总中断打开
	while(1) 
	{
				
	}		
}

/*------------------------------------------------
             单片机初始化子程序
------------------------------------------------*/
void init()
{
	t0_init();
}

/*------------------------------------------------
              定时器0初始化子程序
------------------------------------------------*/
void t0_init()
{
	TMOD &= (0xf0);            
	TMOD |= (0x01);     //使用模式1，16位定时器

	TH0 = (65536-250)/256;
	TL0 = (65536-250)%256;
	
	ET0 = 1;     //定时器中断打开
	TR0 = 1;     //定时器开关打开
}

/*------------------------------------------------
                定时器0中断子程序
------------------------------------------------*/
void t0_isr() interrupt 1
{
	TH0 = (65536-250)/256;    //重新赋值 12M晶振计算，指令周期1uS
	TL0 = (65536-250)%256;    //2KHz=0.5mS 半个周期250us  即定时250次
    
    sq = ~sq;                 //用示波器可看到方波输出 
}


